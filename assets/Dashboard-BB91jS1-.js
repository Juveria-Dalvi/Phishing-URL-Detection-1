import{r as n,j as e,A as l,B as c,G as P,g as z,y as U,z as h}from"./index-BXMt1X_T.js";import{C as H}from"./index.esm-D7KWb2Aq.js";import{C as g}from"./CCardHeader-CsMiqKWO.js";import{C as O,a as J,b as w,c as m,d as Q,e as C}from"./CTable-CUVoth06.js";const K=()=>{const[i,p]=n.useState(""),[f,R]=n.useState([]),[b,L]=n.useState(""),[d,S]=n.useState(0),[o,y]=n.useState(0),[x,v]=n.useState(null),[u,j]=n.useState("");n.useEffect(()=>{const s=JSON.parse(localStorage.getItem("urlResults"))||[];R(s);const t=s.filter(a=>a.isPhishing).length,r=s.length-t;S(t),y(r)},[]);const N=s=>{const t=["phishing","scam","fraud","wwww","http://","@","%","#","&","\\\\",".tk",".ml",".ga",".cf",".gq"],r=/\b(?:\d{1,3}\.){3}\d{1,3}\b/,a=/[^a-zA-Z0-9.-/?:]/g,F=t.some(B=>s.includes(B)),A=r.test(s),D=a.test(s);return F||A||D},I=s=>new RegExp(/^(https?:\/\/)?([a-z0-9.-]+\.[a-z]{2,}|localhost)(:[0-9]{1,5})?(\/.*)?$/i).test(s),T=()=>{if(j(""),!i){j("Please enter a URL.");return}if(!I(i)){j("Please enter a valid URL.");return}const s=N(i);v(s);const t=new Date().toLocaleString("en-US",{timeZone:"Asia/Kolkata"}),r={url:i,isPhishing:s,timestamp:t},a=[...f,r];R(a),p(""),s?S(d+1):y(o+1),localStorage.setItem("urlResults",JSON.stringify(a))},k=f.filter(s=>s.url.toLowerCase().includes(b.toLowerCase())),E={labels:["Safe","Unsafe"],datasets:[{data:[o,d],backgroundColor:["#008000","#FF6384"],hoverBackgroundColor:["#008000","#FF6384"]}]};return e.jsxs(e.Fragment,{children:[e.jsxs(l,{className:"mb-4",children:[e.jsx(g,{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("h5",{children:"Phishing URL Detection"})}),e.jsxs(c,{children:[e.jsx(P,{type:"text",placeholder:"Enter a website URL",value:i,onChange:s=>p(s.target.value),invalid:!!u}),e.jsx(z,{color:"primary",className:"mt-3",onClick:T,children:"Check URL"}),u&&e.jsx("div",{className:"text-danger mt-2",children:u})," ",x!==null&&e.jsx("div",{className:`mt-4 p-3 ${x?"bg-danger":"bg-success"} text-white`,children:x?"This website is NOT SAFE (Phishing URL)":"This website is SAFE"})]})]}),e.jsxs(U,{className:"mb-4",children:[e.jsx(h,{md:6,children:e.jsx(l,{className:"bg-success text-white",children:e.jsxs(c,{children:[e.jsx("h5",{children:"Safe URLs"}),e.jsx("p",{children:o})]})})}),e.jsx(h,{md:6,children:e.jsx(l,{className:"bg-danger text-white",children:e.jsxs(c,{children:[e.jsx("h5",{children:"Unsafe URLs"}),e.jsx("p",{children:d})]})})})]}),e.jsxs(U,{children:[e.jsx(h,{md:6,children:e.jsxs(l,{className:"mb-4",children:[e.jsxs(g,{children:[e.jsx("h5",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:"Checked URLs"}),e.jsx(P,{type:"text",placeholder:"Search URLs",value:b,onChange:s=>L(s.target.value),className:"mt-3"})]}),e.jsx(c,{children:e.jsx("div",{style:{height:"300px",overflowY:"auto"},children:e.jsxs(O,{align:"middle",hover:!0,responsive:!0,children:[e.jsx(J,{children:e.jsxs(w,{children:[e.jsx(m,{children:"Website URL"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Timestamp"})]})}),e.jsx(Q,{children:k.map((s,t)=>e.jsxs(w,{children:[e.jsx(C,{children:s.url}),e.jsx(C,{className:s.isPhishing?"text-danger":"text-success",children:s.isPhishing?"Not Safe":"Safe"}),e.jsx(C,{children:s.timestamp})]},t))})]})})})]})}),e.jsx(h,{md:6,children:e.jsxs(l,{className:"mb-4",children:[e.jsx(g,{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("h5",{children:"Phishing URL Details"})}),e.jsx(c,{children:e.jsx("div",{style:{height:"350px",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(H,{data:E})})})]})})]})]})};export{K as default};
